<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Yi Wei</title>
    <description>A student...
</description>
    <link>http://myblog.***.***/</link>
    <atom:link href="http://myblog.***.***/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Tue, 25 Apr 2017 13:48:56 +0800</pubDate>
    <lastBuildDate>Tue, 25 Apr 2017 13:48:56 +0800</lastBuildDate>
    <generator>Jekyll v2.4.0</generator>
    
      <item>
        <title>How to import data on SQL Server</title>
        <description>&lt;p&gt;因緣際會下，拿到了Transact-SQL(又稱T-SQL)的一個腳本，因為之前沒有碰有使用過，所以在跑這個腳本時
遇到很多小問題，一開始是想以Mac去嘗試，但是爬了一下文章，T-SQL是在Microsoft SQL Server和Sybase SQL Server上的ANSI SQL實作，所以，以下環境是以Windows環境下去解釋。&lt;/p&gt;

&lt;p&gt;看了維基百科解釋&lt;a href=&quot;https://zh.wikipedia.org/wiki/Transact-SQL&quot;&gt;T-SQL&lt;/a&gt;，以及網路上的幾篇文章，再跑腳本前，我預先做了兩個前置作業。&lt;/p&gt;

&lt;p&gt;首先去&lt;a href=&quot;https://azure.microsoft.com/zh-tw/&quot;&gt;Microsoft Azure&lt;/a&gt;，申請一個免費帳戶，這邊需要註冊一個Microsoft帳戶，然後他的訂用帳戶是&lt;code&gt;Free Trial&lt;/code&gt;的免費帳戶，這個帳戶金額有台幣6300的額度可以用，目前這個額度對我來說是夠用的，申請完後，你可以去Azure的入口網站。
&lt;img src=&quot;../../../images/Azure-1.png&quot; alt=&quot;portal&quot; title=&quot;portal&quot;&gt;
進去後可以照著微軟提供的&lt;a href=&quot;https://docs.microsoft.com/zh-tw/azure/sql-database/sql-database-get-started-portal&quot;&gt;文件&lt;/a&gt;去一步一步去建立我們的資料庫，這個文件分步驟教學，很詳細的介紹，可以參考，至於名稱可以依自己喜好命名。他也有提醒要記得設定防火牆，因為這在之後會影響到是否有權限去查詢我們的資料庫。&lt;/p&gt;

&lt;p&gt;再來我去下載&lt;a href=&quot;https://www.microsoft.com/zh-tw/download/details.aspx?id=29062&quot;&gt;SQL Server Management Studio&lt;/a&gt;，這個是SQL Server預設的資料庫管理工具，隨著SQL Server安裝時勾選用戶端的選項而安裝。因為有T-SQL的腳本，所以再將資料匯入我們的SQL Server會比較方便，這邊也有微軟提供的&lt;a href=&quot;https://docs.microsoft.com/zh-tw/azure/sql-database/sql-database-design-first-database#a-namestep-5---connect-to-the-server-using-ssmsa%E6%AD%A5%E9%A9%9F-5---%E4%BD%BF%E7%94%A8-ssms-%E4%BE%86%E9%80%A3%E7%B7%9A%E5%88%B0%E4%BC%BA%E6%9C%8D%E5%99%A8&quot;&gt;使用 SQL Server Management Studio (SSMS) 建立對 Azure SQL Database 伺服器的連線&lt;/a&gt;，這是在開啟SQL Server Management Studio後，我們需要先去與伺服器的連線。&lt;/p&gt;

&lt;p&gt;好了，兩個前置作業都完成了，那是不是直接匯入我們的腳本就可以跑，錯！！！
在這邊我遇到三個問題。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;設定防火牆問題，所以這個很重要，要記得設定防火牆，允許我們有權限去查詢我們的資料庫。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;記得先熟悉T-SQL的語法，這邊有T-SQL的&lt;a href=&quot;https://technet.microsoft.com/zh-tw/library/ms365303.aspx&quot;&gt;教學課程&lt;/a&gt;，我在這邊出現的錯誤是，找不到我的資料庫，最後再腳本檔中發現他並無下面的指令，這個是建立資料庫的語法。
&lt;figure class=&#39;code-highlight-figure&#39;&gt;&lt;div class=&#39;code-highlight&#39;&gt;&lt;pre class=&#39;code-highlight-pre&#39;&gt;&lt;div data-line=&#39;1&#39; class=&#39;code-highlight-row numbered&#39;&gt;&lt;div class=&#39;code-highlight-line&#39;&gt;CREATE DATABASE TestData&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;div data-line=&#39;2&#39; class=&#39;code-highlight-row numbered&#39;&gt;&lt;div class=&#39;code-highlight-line&#39;&gt;GO&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/figure&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;以上兩個錯誤解決後，最後發現記憶體不足，所以無法執行檔案。
&lt;img src=&quot;../../../images/error-ssms.png&quot; alt=&quot;error-ssms&quot; title=&quot;error-ssms&quot;&gt;
爬文發現解決的方式，可以下這個指令：
&lt;code&gt;sqlcmd -S PcName\SQLEXPRESS -U sa -P password -d DataBaseName -i C:\Script.sql -o C:\log.txt&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;-S: 此處為在 SSMS 裡寫在「伺服器名稱」的值&lt;/li&gt;
&lt;li&gt;-U: 此處為在 SSMS 裡寫在「登入」的值&lt;/li&gt;
&lt;li&gt;-P: 此處為在 SSMS 裡寫在「密碼」的值&lt;/li&gt;
&lt;li&gt;-i: 匯入的腳本檔，也就是剛才使用資料庫發行精靈 (SqlPubWiz.exe) 產生出來的檔案&lt;/li&gt;
&lt;li&gt;-o: 匯出的檔案，內容大致是平常在 SSMS 裡執行 SQL 語法時會出現在「訊息」窗格裡的內容（我是覺得這批匯入所產生的 log，和我在 SSMS 執行時看到的訊息量不太一樣）&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;下這筆指令後，發現他噴錯，內容是說腳本的內容有錯誤，這讓我有點不知所措。
最後，我仍相信腳本應該不會有問題，所以我還是嘗試在SSMS做查詢的動作，去嘗試寫入資料，在SSMS上操作是正確的，所以我就去切腳本的檔案，一步一步去跑切出來了檔案，之後很順利的將腳本的檔案匯入我們的SQL Server。
內容總量大約是 2.6 萬筆，資料庫發行精靈產生出的 SQL 腳本大約有 196.2 MB。&lt;/p&gt;
</description>
        <pubDate>Mon, 24 Apr 2017 22:25:08 +0800</pubDate>
        <link>http://myblog.***.***/2017/04/24/how-to-import-data-on-sql-server.html</link>
        <guid isPermaLink="true">http://myblog.***.***/2017/04/24/how-to-import-data-on-sql-server.html</guid>
        
        
      </item>
    
  </channel>
</rss>
